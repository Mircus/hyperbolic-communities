from scipy import sparse
def is_diagonal(M): return M.nnz==M.shape[0]
